record(stringin, "$(P){BPM:$(NO)}FA:Hdr:Buff-Wfm:T") {
  field(DTYP, "Soft Timestamp")
  field(TSEL, "$(P){BPM:$(NO)}FA:Hdr:Buff-Wfm.TIME CP")
  field(INP, "@%Y%H%M%S")
}

record(waveform,"$(P){BPM:$(NO)}FA:Hdr:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 0 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:Cnt:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 4 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:A:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 8 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:B:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 12 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:C:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 16 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:D:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 20 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:RSVD:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 24 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:S:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 28 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:X:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 32 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(waveform,"$(P){BPM:$(NO)}FA:Y:Buff-Wfm") {
    field(DTYP, "PSC Block I32 In")
    field(INP , "@aie_wfm_rx_$(NO) 55 36 40")
    field(SCAN,"I/O Intr")
    field(FTVL,"DOUBLE")
    field(NELM,"$(FA_LEN)")
}

record(longin, "$(P){BPM:$(NO)}DMA:FALen-I") {
    field(DESC, "FA Samples Per Trigger")
    field(DTYP, "PSC Reg")
    field(INP , "@Rx$(NO) 30 80")
    field(SCAN,"I/O Intr")
    field(EGU,  "Samples")
}

record(bi, "$(P){BPM:$(NO)}DMA:FAbusy-I") {
    field(DESC, "DMA FA Active")
    field(DTYP, "PSC Reg")
    field(INP , "@Rx$(NO) 30 92")
    field(MASK, "0x1")
    field(SCAN,"I/O Intr")
    field(ZNAM,"Rdy")
    field(ONAM,"Busy")
}

record(longout, "$(P){BPM:$(NO)}DMA:FALen-SP") {
    field(DESC, "Number of FA samples per trigger")
    field(DTYP, "PSC Single I32")
    field(OUT , "@aie_tx_$(NO) 1 64")
    field(HOPR,"100000")
    field(LOPR,"100")
    field(PINI, "YES")
    field(VAL, "100")
    field(EGU, "Samples")
    info(autosaveFields, "VAL")
    field(FLNK, "$(P){BPM:$(NO)}GoRegSingleWrite")
}

############################################################
#
#  PVs derived from the above values:
#
############################################################

record(waveform,"$(P){BPM:$(NO)}FA:A-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"20000")
  field(FTVL,"DOUBLE")
}

record(waveform,"$(P){BPM:$(NO)}FA:B-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"20000")
  field(FTVL,"DOUBLE")
}

record(waveform,"$(P){BPM:$(NO)}FA:C-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"20000")
  field(FTVL,"DOUBLE")
}

record(waveform,"$(P){BPM:$(NO)}FA:D-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"20000")
  field(FTVL,"DOUBLE")
}

record(waveform,"$(P){BPM:$(NO)}FA:Sum-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"20000")
  field(FTVL,"DOUBLE")
}

record(waveform,"$(P){BPM:$(NO)}FA:X-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"20000")
  field(FTVL,"DOUBLE")
}

record(waveform,"$(P){BPM:$(NO)}FA:Y-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"20000")
  field(FTVL,"DOUBLE")
}

record(waveform,"$(P){BPM:$(NO)}FA:Time-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"20000")
  field(FTVL,"DOUBLE")
}

record(waveform,"$(P){BPM:$(NO)}FA:FFT-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"History")
  field(NELM,"10000")
  field(FTVL,"FLOAT")
}

record(waveform,"$(P){BPM:$(NO)}FA:IPSD-Wfm"){
  field(DTYP,"Soft Channel")
  field(DESC,"Integrated PSD")
  field(NELM,"10000")
  field(FTVL,"FLOAT")
}

record(longout,"$(P){BPM:$(NO)}FA:WfmLen-SP"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(longout,"$(P){BPM:$(NO)}FA:WfmOff-SP"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Aavg-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Bavg-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Cavg-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Davg-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Savg-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Xavg-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Yavg-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Asig-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Bsig-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Csig-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Dsig-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Ssig-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Xsig-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:Ysig-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(longout,"$(P){BPM:$(NO)}FA:Update-SP"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(mbbo,"$(P){BPM:$(NO)}FA:FFT:Chan-SP"){
  field(PINI,"YES")
  field(ZRVL,"0")
  field(ONVL,"1")
  field(TWVL,"2")
  field(THVL,"3")
  field(FRVL,"4")
  field(FVVL,"5")

  field(ZRST,"A")
  field(ONST,"B")
  field(TWST,"C")
  field(THST,"D")
  field(FRST,"X")
  field(FVST,"Y")
}

record(mbbo,"$(P){BPM:$(NO)}FA:FFT:Unit-SP"){
  field(PINI,"YES")
  field(ZRVL,"0")
  field(ONVL,"1")
  field(TWVL,"2")
  field(ZRST,"Volt")
  field(ONST,"dBfs")
  field(TWST,"dBc")
}

record(ai,"$(P){BPM:$(NO)}FA:PeakFreq-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:PeakAmpl-I"){
  field(DTYP,"Soft Channel")
  field(VAL,0)
  field(UDF,0)
}

record(ai,"$(P){BPM:$(NO)}FA:FFT:0Hz-I"){
  field(DTYP,"Soft Channel")
  field(DESC,"FFT Value at 0Hz")
  field(VAL,0)
  field(UDF,0)
}

record(longin,"$(P){BPM:$(NO)}FA:LoopTime-I"){
  field(DTYP,"Soft Channel")
  field(DESC,"FA code execution time")
  field(VAL,0)
  field(EGU,"us")
  field(UDF,0)
}

record(longin,"$(P){BPM:$(NO)}FA:LoopCount-I"){
  field(DTYP,"Soft Channel")
  field(DESC,"FA code loop counter")
  field(VAL,0)
  field(UDF,0)
}

